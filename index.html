<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LearnME</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        /* 今日学习板块内部padding调整 */
        .today-study-card .card-content {
            padding: 20px 20px 0px;
        }

        /* LearnME板块内部padding调整 */
        .learnme-card .card-content {
            padding: 0px 20px 20px;
        }

        .card {
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .card-header {
            padding: 15px 20px 0px;
            border-bottom: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 18px;
            font-weight: 600;
            background-color: rgb(255, 255, 255);
            color: rgb(0, 0, 0);
        }

        .card-header #current-date {
            font-size: 14px;
            color: #696969;
            font-weight: normal;
            margin-top: 5px;
        }

        .card-content {
            padding: 0px 20px 15px;
            background-color: white;
            border-radius: 0 0 12px 12px;
            text-align: center;
        }

        .today-study {
            text-align: center;
            padding: 0px 0 20px;
        }

        .study-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .study-time {
            font-size: 16px;
            color: #666;
            margin-bottom: 20px;
        }

        .preview-btn {
            display: inline-block;
            padding: 8px 16px;
            background-color: #f0f0f0;
            border-radius: 20px;
            color: #333;
            text-decoration: none;
            font-size: 14px;
            cursor: pointer;
        }

        .preview-btn:hover {
            background-color: #e0e0e0;
        }

        .week-plan {
            display: none;
            padding: 15px;
        }

        .week-plan.active {
            display: block;
        }

        .day-item {
            display: flex;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .day-item:last-child {
            border-bottom: none;
        }

        .day-name {
            width: 50px;
            font-weight: bold;
        }

        .day-content {
            flex: 1;
        }

        .today-highlight {
            background-color: #e8f5e9;
            border-radius: 5px;
            padding: 10px 10px;
            margin: 0 -10px;
            height: 100%;
        }

        /* 单词板块样式 */
        .vocab-section {
            margin: 20px 0;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .vocab-header {
            padding: 15px;
            text-align: center;
        }

        .vocab-header h2 {
            margin: 0;
            font-size: 24px;
            color: white;
        }

        .vocab-content {
            background-color: white;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .date-circles-container {
            display: flex;
            justify-content: center;
            width: 100%;
            overflow-x: hidden;
        }

        .date-circles {
            display: flex;
            width: auto;
            max-width: 100%;
            overflow-x: auto;
            padding: 10px 0;
            -webkit-overflow-scrolling: touch;
        }

        .date-circles::-webkit-scrollbar {
            height: 6px;
        }

        .date-circles::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 3px;
        }

        .date-circles::-webkit-scrollbar-track {
            background-color: transparent;
        }

        .date-circle {
            width: 28px;
            height: 28px;
            aspect-ratio: 1/1;
            border-radius: 50%;
            display: flex;
            font-size: 12px;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin: 0 5px;
            flex-shrink: 0;
        }

        .circle-green {
            background-color: green;
        }

        .circle-gray {
            background-color: gray;
        }

        .more-btn {
            text-align: center;
            padding: 10px 0;
        }

        .more-btn a {
            color: #1976d2;
            text-decoration: none;
            cursor: pointer;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
            overscroll-behavior: contain;
        }

        .modal-content {
            background-color: #fff;
            margin: 10% auto;
            border-radius: 12px;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-sizing: border-box;
        }

        .modal-header {
            position: sticky;
            top: 0;
            left: 0;
            right: 0;
            background-color: #fff;
            padding: 20px;
            border-bottom: 1px solid #f0f0f0;
            margin-bottom: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2;
            width: 100%;
            box-sizing: border-box;
            border-top-left-radius: 12px;
            border-top-right-radius: 12px;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 20px;
            background-color: #fff;
            padding: 10px 0;
            flex: 1;
            text-align: center;
            position: relative;
        }

        .close-btn {
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #666;
            line-height: 1;
            padding: 10px;
            position: absolute;
            right: 20px;
        }

        .plan-list {
            margin-top: 0;
            padding: 20px;
            width: 100%;
            box-sizing: border-box;
        }

        .plan-item {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .plan-item .plan-date {
            font-size: 14px;
            color: #666;
        }

        .plan-item .plan-title {
            font-size: 16px;
            font-weight: 500;
        }

        .today-plan-highlight {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
        }

        /* 添加滚动动画平滑效果 */
        html {
            scroll-behavior: smooth;
        }

        .plan-item .plan-time {
            font-size: 14px;
            color: #666;
        }

        /* 单词板块样式 */
        .word-card {
            background-color: #4caf50;
            color: white;
        }

        .date-selector {
            display: flex;
            justify-content: center;
            margin-top: 15px;
        }

        .date-item {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 5px;
            background-color: #e0e0e0;
            cursor: pointer;
        }

        .date-item.active {
            background-color: #4caf50;
            color: white;
        }

        /* LearnME计划样式 */
        .progress-bar {
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: #ff80ab;
            border-radius: 10px;
        }

        .spark-btn {
            display: block;
            background-color: #ff80ab;
            color: white;
            text-align: center;
            padding: 12px;
            border-radius: 8px;
            margin: 20px 0;
            text-decoration: none;
            font-weight: bold;
        }

        .emoji-font {
            font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif;
        }

        /* 新增样式 */
        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        .today-header {
            background-color: #f8f8f8;
            text-align: center;
            padding: 10px;
        }

        .today-date {
            font-size: 14px;
            color: #666;
        }

        .today-course {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0 5px;
        }

        .today-time {
            font-size: 14px;
            color: #666;
        }

        .week-day {
            padding: 8px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
        }

        .week-day.today {
            background-color: #e8f5e9;
        }

        .week-day.weekend {
            background-color: #fce4ec;
        }

        .today-preview {
            margin-top: 10px;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }

        .today-preview .today-line {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .today-preview .today-line .today-tag {
            background-color: #4CAF50;
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            margin-right: 10px;
            font-size: 14px;
        }

        .weekday {
            color: #666;
            margin-left: 8px;
        }

        .weekday.weekend {
            background-color: #fce4ec;
        }

        .day-course {
            flex: 1;
            padding: 0 10px;
        }

        .day-time {
            color: #666;
            font-size: 12px;
            width: 100px;
            text-align: right;
        }

        .saying {
            font-style: italic;
            text-align: center;
            margin: 15px 0;
            color: #888;
            /* 更浅的灰色 */
            font-size: 14px;
            /* 更小的字号 */
        }
    </style>
</head>

<body>
    <!-- 今日学习卡片 -->
    <div class="card today-study-card">
        <div class="card-header">
            今日学习
            <span id="current-date"></span>
        </div>
        <div class="card-content">
            <div class="today-study">
                <div class="study-title" id="study-title"></div>
                <div class="study-time" id="study-time"></div>
                <div class="preview-btn no-highlight" id="toggle-preview">计划预览</div>
            </div>

            <div class="week-plan" id="week-plan">
                <div id="week-plan-content"></div>
                <div class="more-btn no-highlight">
                    <a id="show-all-plans" class="no-highlight">更多</a>
                </div>
            </div>
        </div>
    </div>

    <!-- 单词板块卡片 -->
    <div class="vocab-section">
        <div class="vocab-header" id="vocab-header">
            <h2 id="vocab-title"></h2>
        </div>
        <div class="vocab-content">
            <div class="date-circles" id="date-circles"></div>
        </div>
    </div>

    <!-- LearnME计划卡片 -->
    <div class="card learnme-card">
        <div class="card-header">
            LearnME
            <span id="encourage-message">别放弃，伟大的事情都需要时间</span>
        </div>
        <div class="card-content">

            <div id="spark-status-container" style="margin: 15px 0;">
                <div id="spark-days-container">
                    火花已点燃 <span id="spark-days" style="color: #ff80ab; font-size: 28px;">0</span> 天
                </div>
                <div id="spark-extinguished" style="display: none; color: #616161;">
                    💀火花熄灭了💀
                </div>
            </div>

            <a href="#" class="spark-btn no-highlight" id="spark-button">点燃火花</a>

            <div style="margin: 15px 0;">
                <div id="next-report" style="margin-bottom: 10px;">离下次报告还有 <span class="highlight"
                        style="color: #ff80ab; font-size: 24px;">4</span> 天</div>
                <div>你已经坚持了 <span id="persist-days" style="color: #ff80ab; font-size: 24px;">23</span> 天</div>
            </div>

            <div class="progress-container">
                <div class="progress-bar" id="progress-bar">
                    <div class="progress-fill" style="width: 0%;"></div>
                </div>
                <div id="progress-text">0.00%</div>
            </div>
        </div>
    </div>

    <style>
        .highlight {
            color: #ff80ab;
            font-size: 24px;
            font-weight: bold;
            margin-left: 5px;
            margin-right: 5px;
        }

        .progress-container {
            width: 100%;
            margin-top: 15px;
            position: relative;
            padding-bottom: 20px;
        }

        .progress-bar {
            height: 10px;
            background-color: #e0e0e0;
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: #ff80ab;
            transition: width 0.3s;
        }

        #progress-text {
            position: absolute;
            margin-top: 5px;
            font-size: 12px;
            color: #333;
        }

        /* 居中样式 */
        .card-header #encourage-message {
            font-style: italic;
            color: #696969;
            /* 与current-date相同的颜色 */
            font-size: 12px;
            font-weight: normal;
            margin-top: 5px;
            /* 与current-date相同的上边距 */
            display: block;
            text-align: center;
        }

        .card-content>div:nth-child(2) {
            text-align: center;
        }

        #spark-days {
            font-weight: bold;
        }

        .card-content>div:nth-child(4) {
            text-align: center;
        }

        #persist-days {
            font-weight: bold;
        }

        .no-highlight {
            -webkit-tap-highlight-color: transparent;
            tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        .spark-btn {
            display: block;
            margin: 10px auto;
            text-align: center;
        }
    </style>

    <!-- 全部计划弹窗 -->
    <div class="modal" id="all-plans-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>全部学习计划</h2>
                <span class="close-btn no-highlight" id="close-modal">&times;</span>
            </div>
            <div class="plan-list" id="all-plans-list"></div>
        </div>
    </div>

    <script>
        // 解析list.txt内容
        const studyPlans = [
            ['初高衔接】1等式变形方法回顾', '00:00 - 11:34'],
            ['初高衔接】1等式变形方法回顾', '11:34 - 23:08'],
            ['初高衔接】1等式变形方法回顾', '23:08 - 34:42'],
            ['初高衔接】2不等式解法梳理', '00:00 - 14:36'],
            ['初高衔接】2不等式解法梳理', '14:36 - 29:13'],
            ['集合】1集合的概念（易）', '00:00 - 12:34'],
            ['集合】1集合的概念（易）', '12:34 - 25:09'],
            ['集合】2子集的概念（易）', '00:00 - 13:16'],
            ['集合】2子集的概念（易）', '13:16 - 26:32'],
            ['集合】2子集的概念（易）', '26:32 - 39:50'],
            ['集合】3交并补运算（易）', '00:00 - 11:44'],
            ['集合】3交并补运算（易）', '11:44 - 23:29'],
            ['集合】4综合大题练习（中档）', '0:00 - 13:08'],
            ['集合】5易错大盘点（中档）', '00:00 - 13:58'],
            ['集合】5易错大盘点（中档）', '13:58 - 27:56'],
            ['集合】6新定义问题（中档）', '00:00 - 8:21'],
            ['集合】6新定义问题（中档）', '8:21 - 16:42'],
            ['逻辑】1充分必要条件（易）', '00:00 - 10:01'],
            ['逻辑】1充分必要条件（易）', '10:01 - 20:02'],
            ['逻辑】1充分必要条件（易）', '20:02 - 30:03'],
            ['逻辑】2全称与存在量词（易）', '0:00 - 15:31'],
            ['不等式】1不等式的性质（易）', '00:00 - 12:05'],
            ['不等式】1不等式的性质（易）', '12:05 - 24:10'],
            ['不等式】2基本不等式（易-中档）', '00:00 - 12:33'],
            ['不等式】2基本不等式（易-中档）', '12:33 - 25:06'],
            ['不等式】2基本不等式（易-中档）', '25:06 - 37:40'],
            ['二次】1二次函数中的a、b、c与不等式（中档）', '00:00 - 13:22'],
            ['二次】1二次函数中的a、b、c与不等式（中档）', '13:22 - 26:44'],
            ['二次】2二次函数根分布问题（中档）', '00:00 - 12:04'],
            ['二次】2二次函数根分布问题（中档）', '12:04 - 24:08'],
            ['函数】1引导课：高中为什么用f(x)', '00:00 - 12:16'],
            ['函数】1引导课：高中为什么用f(x)', '12:16 - 24:33'],
            ['函数】2函数概念+定义域（易）', '00:00 - 13:11'],
            ['函数】2函数概念+定义域（易）', '13:11 - 26:22'],
            ['函数】2函数概念+定义域（易）', '26:22 - 39:35'],
            ['函数】3函数解析式求法（易）', '00:00 - 12:28'],
            ['函数】3函数解析式求法（易）', '12:28 - 24:56'],
            ['函数】4分式函数的值域（易）', '00:00 - 12:46'],
            ['函数】4分式函数的值域（易）', '12:46 - 25:32'],
            ['函数】4分式函数的值域（易）', '25:32 - 38:19'],
            ['函数】5函数单调性（易）', '00:00 - 10:58'],
            ['函数】5函数单调性（易）', '10:58 - 21:56'],
            ['函数】5函数单调性（易）', '21:56 - 32:54'],
            ['函数】5函数单调性（易）', '32:54 - 43:52'],
            ['函数】6函数奇偶性（易-中档）', '00:00 - 12:47'],
            ['函数】6函数奇偶性（易-中档）', '12:47 - 25:34'],
            ['函数】6函数奇偶性（易-中档）', '25:34 - 38:21'],
            ['函数】7单调奇偶考法复习（易）', '00:00 - 12:03'],
            ['函数】7单调奇偶考法复习（易）', '12:03 - 24:06'],
            ['函数】8单调奇偶综合拓展（中档）（承接上集）', '00:00 - 13:04'],
            ['函数】8单调奇偶综合拓展（中档）（承接上集）', '13:04 - 26:08'],
            ['函数】8单调奇偶综合拓展（中档）（承接上集）', '26:08 - 39:13'],
            ['初等函数】1幂函数（基础）', '00:00 - 9:47'],
            ['初等函数】1幂函数（基础）', '9:47 - 19:35'],
            ['初等函数】2分数指数幂的计算（基础）', '00:00 - 8:06'],
            ['初等函数】2分数指数幂的计算（基础）', '8:06 - 16:12'],
            ['初等函数】3指数函数（基础）', '00:00 - 10:42'],
            ['初等函数】3指数函数（基础）', '10:42 - 21:25'],
            ['初等函数】4对数定义+基本运算规则（基础）', '00:00 - 13:12'],
            ['初等函数】4对数定义+基本运算规则（基础）', '13:12 - 26:24'],
            ['初等函数】5对数换底公式+练习（基础）', '0:00 - 15:27'],
            ['初等函数】6对数函数（基础）', '00:00 - 11:05'],
            ['初等函数】6对数函数（基础）', '11:05 - 22:10'],
            ['初等函数】7初等函数知识串讲复习（基础-中档）', '00:00 - 11:06'],
            ['初等函数】7初等函数知识串讲复习（基础-中档）', '11:06 - 22:13'],
            ['初等函数】8指数、对数大小比较题型解析(中档)', '00:00 - 12:22'],
            ['初等函数】8指数、对数大小比较题型解析(中档)', '12:22 - 24:45'],
            ['初等函数】9初等函数图像与性质考点解析（中档）', '00:00 - 11:23'],
            ['初等函数】9初等函数图像与性质考点解析（中档）', '11:23 - 22:46'],
            ['初等函数】9初等函数图像与性质考点解析（中档）', '22:46 - 34:11'],
            ['【函数综合】【考点精华】1零点存在性定理的运用（基础）', '00:00 - 10:38'],
            ['【函数综合】【考点精华】1零点存在性定理的运用（基础）', '10:38 - 21:16'],
            ['【函数综合】【考点精华】1零点存在性定理的运用（基础）', '21:16 - 31:55'],
            ['【函数综合】【考点精华】2复合函数考点解析（基础）', '0:00 - 13:50'],
            ['【函数综合】【考点精华】3分段函数解题思路（中档）', '00:00 - 11:01'],
            ['【函数综合】【考点精华】3分段函数解题思路（中档）', '11:01 - 22:02'],
            ['【函数综合】【考点精华】5抽象函数考点解析上（基础）', '00:00 - 9:02'],
            ['【函数综合】【考点精华】5抽象函数考点解析上（基础）', '9:02 - 18:05'],
            ['三角函数】1任意角的表示（易）', '00:00 - 9:58'],
            ['三角函数】1任意角的表示（易）', '9:58 - 19:57'],
            ['三角函数】2弧度制（易）', '00:00 - 8:49'],
            ['三角函数】2弧度制（易）', '8:49 - 17:39'],
            ['三角函数】3弧长与扇形面积公式（易）', '00:00 - 8:32'],
            ['三角函数】3弧长与扇形面积公式（易）', '8:32 - 17:05'],
            ['三角函数】4三角函数的定义（易）', '00:00 - 14:00'],
            ['三角函数】4三角函数的定义（易）', '14:00 - 28:00'],
            ['三角函数】5同角三角函数关系（易+中档）', '00:00 - 8:12'],
            ['三角函数】5同角三角函数关系（易+中档）', '8:12 - 16:25'],
            ['三角函数】6诱导公式（易）', '00:00 - 11:31'],
            ['三角函数】6诱导公式（易）', '11:31 - 23:02'],
            ['三角函数】6诱导公式（易）', '23:02 - 34:34'],
            ['三角函数】7sinx的图像与性质（易+中档）', '00:00 - 10:44'],
            ['三角函数】7sinx的图像与性质（易+中档）', '10:44 - 21:28'],
            ['三角函数】7sinx的图像与性质（易+中档）', '21:28 - 32:14'],
            ['三角函数】8cosx的图像与性质（易+中档）', '0:00 - 13:43'],
            ['三角函数】9tanx的图像与性质（易+中档）', '0:00 - 07:40'],
            ['三角函数】10三角4个解题妙招（中档）', '00:00 - 13:46'],
            ['三角函数】10三角4个解题妙招（中档）', '13:46 - 27:33'],
            ['三角函数】11三角函数的平移伸缩（易）', '0:00 - 15:02'],
            ['三角函数】12三角函数一般形式的各参数含义（易）', '0:00 - 10:49'],
            ['三角函数】13整体换元法（中档）', '00:00 - 14:40'],
            ['三角函数】13整体换元法（中档）', '14:40 - 29:21'],
            ['【三角函数】【考点精华】1图像解决三角函数不等式问题(基础）', '00:00 - 9:50'],
            ['【三角函数】【考点精华】1图像解决三角函数不等式问题(基础）', '9:50 - 19:40'],
            ['【三角函数】【考点精华】3三角函数对称性（重要）（中档）', '00:00 - 11:22'],
            ['【三角函数】【考点精华】3三角函数对称性（重要）（中档）', '11:22 - 22:44'],
            ['【三角函数】【考点精华】3三角函数对称性（重要）（中档）', '22:44 - 34:08'],
            ['【三角函数】【考点精华】4三角函数的单调性（重要）（中档）', '00:00 - 12:05'],
            ['【三角函数】【考点精华】4三角函数的单调性（重要）（中档）', '12:05 - 24:11'],
            ['三角恒等变换】1sincos两角和差公式（易）', '00:00 - 10:55'],
            ['三角恒等变换】1sincos两角和差公式（易）', '10:55 - 21:50'],
            ['三角恒等变换】1sincos两角和差公式（易）', '21:50 - 32:46'],
            ['三角恒等变换】2tan两角和差公式（易）', '0:00 - 13:08'],
            ['三角恒等变换】3两角和差公式进阶练习（中档）', '00:00 - 10:42'],
            ['三角恒等变换】3两角和差公式进阶练习（中档）', '10:42 - 21:24'],
            ['三角恒等变换】4二倍角公式（易）', '00:00 - 11:50'],
            ['三角恒等变换】4二倍角公式（易）', '11:50 - 23:41'],
            ['三角恒等变换】5二倍角公式进阶变形（中档）', '0:00 - 15:16'],
            ['三角恒等变换】6二倍角与半角公式复习（中档）', '00:00 - 10:32'],
            ['三角恒等变换】6二倍角与半角公式复习（中档）', '10:32 - 21:04'],
            ['三角恒等变换】7辅助角公式（易）', '00:00 - 13:51'],
            ['三角恒等变换】7辅助角公式（易）', '13:51 - 27:43'],
            ['平面向量】1平面向量的概念（易）', '00:00 - 8:04'],
            ['平面向量】1平面向量的概念（易）', '8:04 - 16:08'],
            ['平面向量】2向量的加减数乘运算（易）', '00:00 - 10:50'],
            ['平面向量】2向量的加减数乘运算（易）', '10:50 - 21:41'],
            ['平面向量】4向量的数量积（易）', '00:00 - 13:03'],
            ['平面向量】4向量的数量积（易）', '13:03 - 26:06'],
            ['平面向量】6平面向量基本定理（易）', '0:00 - 13:24'],
            ['平面向量】7向量的坐标运算（易）', '00:00 - 11:42'],
            ['平面向量】7向量的坐标运算（易）', '11:42 - 23:25'],
            ['解三角形】1正余弦定理基础（易）', '00:00 - 10:39'],
            ['解三角形】1正余弦定理基础（易）', '10:39 - 21:18'],
            ['解三角形】1正余弦定理基础（易）', '21:18 - 31:58'],
            ['解三角形】2角形解个数与测量（中档）', '00:00 - 12:30'],
            ['解三角形】2角形解个数与测量（中档）', '12:30 - 25:00'],
            ['解三角形】3边角化简（中档）', '00:00 - 11:40'],
            ['解三角形】3边角化简（中档）', '11:40 - 23:20'],
            ['解三角形】3边角化简（中档）', '23:20 - 35:02'],
            ['【解三角形】【总结】第一问思路整理（基础）', '00:00 - 8:21'],
            ['【解三角形】【总结】第一问思路整理（基础）', '8:21 - 16:43'],
            ['【解三角形】【总结】第二问思路整理（中档）', '00:00 - 14:46'],
            ['【解三角形】【总结】第二问思路整理（中档）', '14:46 - 29:32'],
            ['【数列】【一数辞典】1数列的概念与表示方法', '00:00 - 12:30'],
            ['【数列】【一数辞典】1数列的概念与表示方法', '12:30 - 25:00'],
            ['【数列】【一数辞典】2等差数列的概念', '00:00 - 9:07'],
            ['【数列】【一数辞典】2等差数列的概念', '9:07 - 18:15'],
            ['【数列】【一数辞典】3等差数列的前n项和', '00:00 - 13:18'],
            ['【数列】【一数辞典】3等差数列的前n项和', '13:18 - 26:36'],
            ['【数列】【一数辞典】4等差数列习题课', '00:00 - 12:43'],
            ['【数列】【一数辞典】4等差数列习题课', '12:43 - 25:27'],
            ['【数列】【一数辞典】5等比数列的概念', '0:00 - 13:16'],
            ['【数列】【一数辞典】6等比数列的前n项和', '0:00 - 12:59'],
            ['【数列】【考点精华】7累加法题型一网打尽（中档）', '00:00 - 9:55'],
            ['【数列】【考点精华】7累加法题型一网打尽（中档）', '9:55 - 19:51'],
            ['【数列】【考点精华】8累乘法题型一网打尽（中档）', '00:00 - 8:16'],
            ['【数列】【考点精华】8累乘法题型一网打尽（中档）', '8:16 - 16:33'],
            ['【数列】【考点精华】9待定系数与换元法求解通项公式（重要）（中档）', '00:00 - 10:36'],
            ['【数列】【考点精华】9待定系数与换元法求解通项公式（重要）（中档）', '10:36 - 21:12'],
            ['【数列】【考点精华】10等差等比数列的和与通项公式的特殊关系（中档）', '00:00 - 9:35'],
            ['【数列】【考点精华】10等差等比数列的和与通项公式的特殊关系（中档）', '9:35 - 19:10'],
            ['【数列】【考点精华】11An、Sn混搭型数列求解思路（中档）', '00:00 - 8:25'],
            ['【数列】【考点精华】11An、Sn混搭型数列求解思路（中档）', '8:25 - 16:50'],
            ['【数列】【考点精华】12错位相减法求数列的和（必看）（中档）', '00:00 - 8:58'],
            ['【数列】【考点精华】12错位相减法求数列的和（必看）（中档）', '8:58 - 17:57'],
            ['【数列】【考点精华】13裂项相消法求数列的和（必看）（中档）', '00:00 - 11:02'],
            ['【数列】【考点精华】13裂项相消法求数列的和（必看）（中档）', '11:02 - 22:05'],
            ['【数列】【考点精华】14倒序相加与分组求和法（基础）', '0:00 - 13:58'],
            ['【不等式】【一数辞典】1等式与不等式的性质（初中知识回顾）', '0:00 - 14:14'],
            ['【不等式】【一数辞典】2基本不等式', '0:00 - 09:41'],
            ['【不等式】【考点精华】3“1”的代换（中档）', '0:00 - 11:40'],
            ['【不等式】【考点精华】4基本不等式中的“凑形”(中档）', '0:00 - 13:29'],
            ['【不等式】【考点精华】5基本不等式（从一到无穷大系列）', '00:00 - 8:42'],
            ['【不等式】【考点精华】5基本不等式（从一到无穷大系列）', '8:42 - 17:24'],
            ['【不等式】【一数辞典】6二元一次不等式（组）与线性规划（老高考）', '0:00 - 11:49'],
            ['【复数】【一数辞典】1复数的概念', '00:00 - 8:37'],
            ['【复数】【一数辞典】1复数的概念', '8:37 - 17:14'],
            ['【复数】【一数辞典】2复数的四则运算', '00:00 - 8:01'],
            ['【复数】【一数辞典】2复数的四则运算', '8:01 - 16:02'],
            ['【复数】【一数辞典】3复数的三角形式（选学）', '0:00 - 15:37'],
            ['【复数】【考点精华】3复数例题综合演练（基础）', '00:00 - 8:56'],
            ['【复数】【考点精华】3复数例题综合演练（基础）', '8:56 - 17:53'],
            ['【立体几何】【一数辞典】1基本立体图形', '00:00 - 10:54'],
            ['【立体几何】【一数辞典】1基本立体图形', '10:54 - 21:48'],
            ['【立体几何】【一数辞典】1基本立体图形', '21:48 - 32:43'],
            ['【立体几何】【一数辞典】2立体图形的三视图', '00:00 - 13:28'],
            ['【立体几何】【一数辞典】2立体图形的三视图', '13:28 - 26:56'],
            ['【立体几何】【一数辞典】3立体图形的直观图', '00:00 - 11:18'],
            ['【立体几何】【一数辞典】3立体图形的直观图', '11:18 - 22:37'],
            ['【立体几何】【一数辞典】4简单几何体的表面积与体积', '00:00 - 11:49'],
            ['【立体几何】【一数辞典】4简单几何体的表面积与体积', '11:49 - 23:38'],
            ['【立体几何】【考点精华】5几何体的结构问题（基础）', '0:00 - 13:01'],
            ['【立体几何】【考点精华】6几何体的展开问题（中档）', '0:00 - 13:44'],
            ['【立体几何】【考点精华】7动态图形探究（中档）', '00:00 - 10:12'],
            ['【立体几何】【考点精华】7动态图形探究（中档）', '10:12 - 20:25'],
            ['【立体几何】【一数辞典】8平面的定义与公理', '0:00 - 14:52'],
            ['【立体几何】【一数辞典】9空间中直线与直线的位置关系', '00:00 - 8:26'],
            ['【立体几何】【一数辞典】9空间中直线与直线的位置关系', '8:26 - 16:52'],
            ['【立体几何】【一数辞典】10与平面相关的位置关系', '0:00 - 12:55'],
            ['【立体几何】【一数辞典】11空间中的夹角与习题课', '00:00 - 12:17'],
            ['【立体几何】【一数辞典】11空间中的夹角与习题课', '12:17 - 24:35'],
            ['【立体几何】【一数辞典】12线面平行的判定与性质', '0:00 - 15:01'],
            ['【立体几何】【一数辞典】13面面平行的判定与性质', '0:00 - 13:53'],
            ['【立体几何】【一数辞典】14线面垂直的判定与性质', '00:00 - 8:53'],
            ['【立体几何】【一数辞典】14线面垂直的判定与性质', '8:53 - 17:46'],
            ['【立体几何】【一数辞典】15二面角与面面垂直', '00:00 - 11:16'],
            ['【立体几何】【一数辞典】15二面角与面面垂直', '11:16 - 22:32'],
            ['【立体几何】【一数辞典】16判定与性质定理习题课', '00:00 - 12:21'],
            ['【立体几何】【一数辞典】16判定与性质定理习题课', '12:21 - 24:42'],
            ['【立体几何】【考点精华】17外接球之墙角模型（基础）', '0:00 - 11:03'],
            ['【立体几何】【考点精华】18外接球之外心法（中档）', '00:00 - 8:19'],
            ['【立体几何】【考点精华】18外接球之外心法（中档）', '8:19 - 16:38'],
            ['【立体几何】【考点精华】22特殊图形的动点问题（中档）', '00:00 - 10:34'],
            ['【立体几何】【考点精华】22特殊图形的动点问题（中档）', '10:34 - 21:08'],
            ['【立体几何】【考点精华】23三点确定截面精确位置（基础）', '0:00 - 14:03'],
            ['【立体几何】【考点精华】24棱柱中的截面画法（中档）', '00:00 - 8:55'],
            ['【立体几何】【考点精华】24棱柱中的截面画法（中档）', '8:55 - 17:50'],
            ['【统计】【一数辞典】2频率的表示方法', '00:00 - 12:38'],
            ['【统计】【一数辞典】2频率的表示方法', '12:38 - 25:17'],
            ['【统计】【一数辞典】1随机抽样', '00:00 - 10:03'],
            ['【统计】【一数辞典】1随机抽样', '10:03 - 20:06'],
            ['【统计】【一数辞典】3样本的数字特征', '00:00 - 11:14'],
            ['【统计】【一数辞典】3样本的数字特征', '11:14 - 22:29'],
            ['【统计】【一数辞典】4百分位数（新教材内容）', '00:00 - 12:32'],
            ['【统计】【一数辞典】4百分位数（新教材内容）', '12:32 - 25:05'],
            ['【统计】【一数辞典】5方差知识补充（中档）（新教材内容）', '00:00 - 10:57'],
            ['【统计】【一数辞典】5方差知识补充（中档）（新教材内容）', '10:57 - 21:55'],
            ['【概率】【一数辞典】1样本空间与随机事件', '00:00 - 10:44'],
            ['【概率】【一数辞典】1样本空间与随机事件', '10:44 - 21:29'],
            ['【概率】【一数辞典】2事件的关系与运算', '00:00 - 9:26'],
            ['【概率】【一数辞典】2事件的关系与运算', '9:26 - 18:53'],
            ['【概率】【一数辞典】3古典概型', '00:00 - 11:35'],
            ['【概率】【一数辞典】3古典概型', '11:35 - 23:11'],
            ['【概率】【一数辞典】4概率的基本（运算）性质', '00:00 - 13:15'],
            ['【概率】【一数辞典】4概率的基本（运算）性质', '13:15 - 26:31'],
            ['【概率】【一数辞典】5事件的相互独立', '00:00 - 14:58'],
            ['【概率】【一数辞典】5事件的相互独立', '14:58 - 29:57'],
            ['【概率】【一数辞典】6频率与概率', '0:00 - 14:35'],
            ['空间向量】1空间向量及其运算（易）', '00:00 - 9:36'],
            ['空间向量】1空间向量及其运算（易）', '9:36 - 19:13'],
            ['空间向量】2建系与坐标运算（易）', '00:00 - 9:56'],
            ['空间向量】2建系与坐标运算（易）', '9:56 - 19:53'],
            ['空间向量】3证明平行垂直（易-中档）', '00:00 - 13:11'],
            ['空间向量】3证明平行垂直（易-中档）', '13:11 - 26:23'],
            ['空间向量】4空间中的角度问题（中档）', '00:00 - 12:29'],
            ['空间向量】4空间中的角度问题（中档）', '12:29 - 24:58'],
            ['空间向量】4空间中的角度问题（中档）', '24:58 - 37:27'],
            ['空间向量】5空间中的距离问题（中档）', '00:00 - 10:20'],
            ['空间向量】5空间中的距离问题（中档）', '10:20 - 20:40'],
            ['空间向量】5空间中的距离问题（中档）', '20:40 - 31:00'],
            ['空间向量】5空间中的距离问题（中档）', '31:00 - 41:20'],
            ['空间向量】5空间中的距离问题（中档）', '41:20 - 51:42'],
            ['空间向量】7空间角度几何法讲解（中档）', '00:00 - 10:59'],
            ['空间向量】7空间角度几何法讲解（中档）', '10:59 - 21:58'],
            ['空间向量】7空间角度几何法讲解（中档）', '21:58 - 32:57'],
            ['空间向量】7空间角度几何法讲解（中档）', '32:57 - 43:56'],
            ['空间向量】7空间角度几何法讲解（中档）', '43:56 - 54:56'],
            ['直线与圆】1直线倾斜角与斜率（易）', '00:00 - 14:15'],
            ['直线与圆】1直线倾斜角与斜率（易）', '14:15 - 28:30'],
            ['直线与圆】2直线的方程（易）', '0:00 - 15:09'],
            ['直线与圆】3交点坐标与距离公式（易-中档）', '00:00 - 10:53'],
            ['直线与圆】3交点坐标与距离公式（易-中档）', '10:53 - 21:46'],
            ['直线与圆】3交点坐标与距离公式（易-中档）', '21:46 - 32:39'],
            ['直线与圆】4圆的标准方程（易）', '00:00 - 12:02'],
            ['直线与圆】4圆的标准方程（易）', '12:02 - 24:05'],
            ['直线与圆】5圆的一般方程（易）', '00:00 - 13:58'],
            ['直线与圆】5圆的一般方程（易）', '13:58 - 27:56'],
            ['直线与圆】6直线与圆位置关系（易-中档）', '00:00 - 11:20'],
            ['直线与圆】6直线与圆位置关系（易-中档）', '11:20 - 22:40'],
            ['直线与圆】6直线与圆位置关系（易-中档）', '22:40 - 34:02'],
            ['直线与圆】7圆与圆的位置关系（中档）', '00:00 - 12:50'],
            ['直线与圆】7圆与圆的位置关系（中档）', '12:50 - 25:40'],
            ['直线与圆】8直线与圆的最值问题（中档）', '00:00 - 13:38'],
            ['直线与圆】8直线与圆的最值问题（中档）', '13:38 - 27:17'],
            ['圆锥曲线】1椭圆的标准方程（易）', '00:00 - 12:33'],
            ['圆锥曲线】1椭圆的标准方程（易）', '12:33 - 25:07'],
            ['圆锥曲线】2椭圆核心题型（中档）', '00:00 - 13:04'],
            ['圆锥曲线】2椭圆核心题型（中档）', '13:04 - 26:08'],
            ['圆锥曲线】2椭圆核心题型（中档）', '26:08 - 39:14'],
            ['圆锥曲线】5双曲线的标准方程（易）', '00:00 - 10:23'],
            ['圆锥曲线】5双曲线的标准方程（易）', '10:23 - 20:47'],
            ['圆锥曲线】6双曲线的几何性质（易-中档）', '00:00 - 11:58'],
            ['圆锥曲线】6双曲线的几何性质（易-中档）', '11:58 - 23:56'],
            ['圆锥曲线】8抛物线的标准方程与常见题型（易）', '00:00 - 13:23'],
            ['圆锥曲线】8抛物线的标准方程与常见题型（易）', '13:23 - 26:46'],
            ['圆锥曲线大题】10解析大题方法论（中档）', '00:00 - 10:45'],
            ['圆锥曲线大题】10解析大题方法论（中档）', '10:45 - 21:30'],
            ['圆锥曲线大题】10解析大题方法论（中档）', '21:30 - 32:15'],
            ['【导数】【一数辞典】1导数的概念与意义', '00:00 - 8:02'],
            ['【导数】【一数辞典】1导数的概念与意义', '8:02 - 16:04'],
            ['【导数】【一数辞典】2常见函数的导数', '0:00 - 14:45'],
            ['【导数】【一数辞典】3导数的运算法则（略难）', '00:00 - 8:17'],
            ['【导数】【一数辞典】3导数的运算法则（略难）', '8:17 - 16:34'],
            ['【导数】【一数辞典】4导数的运算法则习题课（中档）', '0:00 - 12:15'],
            ['【导数】【一数辞典】5函数单调性与导数（重要）', '0:00 - 11:22'],
            ['【导数】【一数辞典】6极值与最值', '0:00 - 12:14'],
            ['【导数】【考点精华】7导数与几何意义考点解析（基础）', '0:00 - 08:31'],
            ['【导数】【考点精华】8构造函数值比较大小（中档）', '0:00 - 11:28'],
            ['【导数】【考点精华】10复合函数的求导问题（基础）', '0:00 - 11:35'],
            ['【导数】【压轴】3未知极值点的处理（中档）', '0:00 - 08:22'],
            ['【导数】【压轴】6常见三连放缩（中档）', '00:00 - 8:58'],
            ['【导数】【压轴】6常见三连放缩（中档）', '8:58 - 17:57'],
            ['【计数原理】【一数辞典】1加法与乘法原理', '0:00 - 09:53'],
            ['【计数原理】【一数辞典】2排列', '00:00 - 10:41'],
            ['【计数原理】【一数辞典】2排列', '10:41 - 21:23'],
            ['【计数原理】【一数辞典】3组合', '00:00 - 9:20'],
            ['【计数原理】【一数辞典】3组合', '9:20 - 18:41'],
            ['【计数原理】【补充】什么时候用排列，什么时候用组合', '0:00 - 14:09'],
            ['【计数原理】【一数辞典】4排列与组合的运用（习题课）', '00:00 - 9:12'],
            ['【计数原理】【一数辞典】4排列与组合的运用（习题课）', '9:12 - 18:24'],
            ['【计数原理】【一数辞典】5二项式定理与通项', '0:00 - 14:46'],
            ['【计数原理】【一数辞典】6二项式的性质', '00:00 - 8:54'],
            ['【计数原理】【一数辞典】6二项式的性质', '8:54 - 17:49'],
            ['【计数原理】【考点精华】7初识计数题型（基础）', '0:00 - 11:54'],
            ['【计数原理】【考点精华】8捆绑法与插空法（基础）', '0:00 - 14:50'],
            ['【计数原理】【考点精华】9隔板法（中档）', '0:00 - 15:38'],
            ['【计数原理】【考点精华】10分组分配问题（中档）', '0:00 - 13:00'],
            ['【计数原理】【考点精华】12组合计数之间接法（中档）', '0:00 - 14:13'],
            ['【计数原理】【考点精华】13一道好题学会排列组合问题核心策略（中档）', '0:00 - 11:44'],
            ['【计数原理】【考点精华】14创新性排列组合问题如何思考？（中档）', '00:00 - 10:35'],
            ['【计数原理】【考点精华】14创新性排列组合问题如何思考？（中档）', '10:35 - 21:11'],
            ['【计数原理】【考点精华】15常规二项式问题（基础）', '0:00 - 09:49'],
            ['【随机变量】【一数辞典】1条件概率与独立事件', '00:00 - 10:52'],
            ['【随机变量】【一数辞典】1条件概率与独立事件', '10:52 - 21:44'],
            ['【随机变量】【一数辞典】2离散型随机变量及其分布列', '00:00 - 10:01'],
            ['【随机变量】【一数辞典】2离散型随机变量及其分布列', '10:01 - 20:03'],
            ['【随机变量】【一数辞典】3离散型随机变量的均值与方差', '00:00 - 12:58'],
            ['【随机变量】【一数辞典】3离散型随机变量的均值与方差', '12:58 - 25:57'],
            ['【随机变量】【一数辞典】4独立重复试验', '00:00 - 11:14'],
            ['【随机变量】【一数辞典】4独立重复试验', '11:14 - 22:28'],
            ['【随机变量】【一数辞典】5随机变量习题课（基础）', '00:00 - 9:07'],
            ['【随机变量】【一数辞典】5随机变量习题课（基础）', '9:07 - 18:15'],
            ['【随机变量】【一数辞典】6正态分布', '00:00 - 10:07'],
            ['【随机变量】【一数辞典】6正态分布', '10:07 - 20:14'],
            ['【随机变量】【一数辞典】7正态分布习题课', '0:00 - 14:12'],
            ['【成对数据统计】【一数辞典】1线性回归方程', '00:00 - 9:59'],
            ['【成对数据统计】【一数辞典】1线性回归方程', '9:59 - 19:58'],
            ['【成对数据统计】【一数辞典】2线性回归习题课', '0:00 - 12:02'],
            ['【成对数据统计】【一数辞典】3独立性检验', '00:00 - 10:21'],
            ['【成对数据统计】【一数辞典】3独立性检验', '10:21 - 20:42']
        ];

        // 鼓励语
        const encourageMessages = [
            "🎉恭喜🎉",
            "💪继续保持💪",
            "👀Look into my eyes👀",
            "😮哇噻😮",
            "🌏拯救世界就看你了🌏",
            "👍那很好了👍",
            "🎈不要放弃🎈",
            "✨你就是夜空中最亮的那颗星✨",
            "🚀继续前进🚀",
            "🔥接着卷不要停🔥",
            "🌚接着肝🌚",
            "🤌接着奏乐接着舞🤌",
            "💅今天也是精致续火人💅",
            "⚡️你就是续火的神⚡️",
            "🏆电子奖杯颁给坚持的你🏆",
            "🦦水獭拍爪（鼓掌版）🦦",
            "🚁直升机式螺旋坚持🚁",
            "🦾血肉苦弱机械飞升🦾",
            "☄️彗星撞地球式续火☄️",
            "🐎驾驾驾续火的驾🐎",
            "🥹救命…坚持到让人害怕…🥹",
            "🧚🏻公主请续火🧚🏻",
            "🌱发芽进度+0.29%🌱",
            "🔥火花加载中🔥",
            "💥今日火花已点燃💥",
            "🌪️火花旋风刮起来🌪️",
            "✨星光火花双倍闪耀✨",
            "🦄魔法火花喷射中🦄",
            "☄️流星火花撞地球☄️",
            "🎇电子烟花为你绽放🎇",
            "🕯️圣火传递但传的是火花🕯️",
            "🧨噼里啪啦火花升级🧨",
            "⚡️雷电火花交叉感染⚡️",
            "🌠银河火花限定供应🌠",
            "🍳煎蛋溅出励志火花🍳",
            "🎆火花人，火花魂🎆",
            "💫宇宙火花收藏家💫",
            "🖍️火花标记今日份闪耀🖍️",
            "🙃满分10分我给你打8.6分🙃\n因为我有1.4了",
            "🧯（假装灭火）火花太旺了🧯",
            "🔮水晶球预判：火花持续燃烧🔮",
            "🎬火花连续剧第N集🎬",
            "🌈彩虹火花限量发射🌈",
            "🔥电子火花饲养员🔥",
            "🧘功德+1🧘",
            "🤖AI检测到🤖\n您的坚持已击败99%人类",
            "🚀法修散打！火花连击999🚀",
            "🦥树獭闪电侠模式启动🦥",
            "😋月亮不睡我不睡，我是人间小美味😋",
            "💫小小的老子，大大的火花💫",
            "🍜泡面可以泡不到，火花必须续到🍜",
            "🧊这何尝不是一种冰镇式坚持🧊",
            "🎮火花副本今日通关√🎮",
            "🛸外星人看了都问火花怎么养🛸",
            "📈火花KPI超额完成📈",
            "🪐跨次元火花协议签订🪐",
            "🌸火花续燃的速度是秒速五次元🌸",
            "👽!@#$%^&*👽",
            "🐴喜欢马驾骑被你发现🐴",
            "🤔嗯，用户点燃了火花…🤔",
            "🥤咕咚…咕咚…嗝～🥤",
            "🐧你要充Q币嘛🐧",
            "🔥爱如火，它温暖了心窝🔥",
            "😾哈！😾",
            "🐤叮咚鸡，大狗叫🐤",
            "🤪如何呢，又能怎？🤪",
            "🌋火山喷发式火花迸溅🌋",
            "啊啊啊啊啊啊啊啊啊\n🍰宝宝你是一个香香软软的小蛋糕🍰",
            "🐈oiiaiaoiiiai🐈",
            "😥不要…忘记…点…火花…😥",
            "🧠9.9包邮爱因斯坦的大脑🧠",
            "🛫芜湖～起飞🛫",
            "🏓教练对我说～🏓",
            "📗不要忘记每天复习单词📗",
            "☕给你倒一杯卡布奇诺☕",
            "🍻Cheers🍻",
            "🦶留下足迹🦶",
            "🌹送你999朵玫瑰🌹",
            "🐆知识学爆🐆",
            "🧀完蛋！我被知识包围了！🧀",
            "☀接下来，要开始放晴了哦☀",

        ];

        // 名言
        const sayings = [
            "相信自己，你能做到！",
            "每一步都算数，继续前进！",
            "今天是全新的机会，好好把握！",
            "你的努力，终将有所回报",
            "坚持下去，胜利就在前方",
            "你比自己想象的更强大！",
            "每天进步一点点，就是成功的开始",
            "别放弃，伟大的事情都需要时间",
            "你的潜力是无限的！",
            "专注当下，创造美好未来",
            "困难只是暂时的，勇气是永恒的",
            "你已经走了很远的路，继续加油！",
            "相信过程，结果会如你所愿",
            "每一次挑战，都是成长的机会",
            "保持积极，好事将会发生",
            "你的坚持，自有意义",
            "别停下脚步，前方有惊喜！",
            "微小的进步，也值得骄傲",
            "你拥有跨越难关的力量！",
            "耐心一点，时光会给你答案",
            "此刻的付出，未来会看见",
            "别怀疑自己，你本就优秀！",
            "一步一步来，总能抵达想去的地方",
            "困境会过去，光芒会照进来！",
            "你的努力，从未被辜负",
            "再试一次，或许就有新的可能！",
            "相信自己的节奏，不必慌张",
            "每一次出发，都离梦想更近",
            "你比昨天的自己更勇敢！",
            "保持热爱，一切会慢慢变好",
            "你走过的每段路，都在塑造更好的你",
            "别小看自己，你藏着无限可能！",
            "慢慢来，好的结果需要沉淀",
            "此刻的坚持，会成为未来的底气！",
            "你的用心，时光都记得",
            "别被暂时的困难困住脚步！",
            "每天多一点勇气，生活就会不一样",
            "你值得被期待，也值得被肯定！",
            "低谷会过去，阳光总在风雨后",
            "再往前一点，就能看到新的风景！",
            "你的努力，自有它的重量",
            "别放弃探索，世界会给你惊喜！",
            "按自己的步调前行，终会抵达",
            "你比想象中更能扛住压力！",
            "微小的光，也能照亮前行的路",
            "保持热情，未来会为你而来！",
            "今天的坚持，明天的辉煌！",
            "你值得所有美好，绝不妥协！",
            "跌倒了就起身，风景在前方！",
            "行动会证明，一切皆有可能",
            "你的光芒，无需他人定义！",
            "缓慢前行，也好过原地停留",
            "逆境中的你正在悄悄绽放",
            "未来可期，请务必相信自己",
            "每份付出，都在积累幸运",
            "星辰大海，终会为你点亮",
            "你的故事，由自己亲手书写",
            "不必完美，只需勇敢开始",
            "希望就在下一秒，请别低头",
            "你的人生，注定与众不同！",
            "坚持初心，时间会给你答案",
            "向前走，美好正在奔向你",
            "你的意志，足以改变现实！",
            "平凡的日子，也会闪着光！",
            "梦想虽远，脚步终将抵达",
            "你做的选择自有它的意义",
            "世界从不辜负默默努力的人",
            "今日的汗水，明日的骄傲！",
            "你比困难，更强大一寸！",
            "静心耕耘，收获自会到来",
            "人生没有白走的路，每一步都作数",
            "你的坚持终会遇见惊喜",
            "抬起头，前方就是曙光",
            "你不止于此，未来会更高！",
            "时间从不会辜负真诚的心",
            "哪怕缓慢，也要持续向前！",
            "你的勇气，正在改变命运！",
            "心有所向，何惧道阻且长！",
            "努力的人，世界会为你让路",
            "你正在成为更好的自己",
            "别急，花开需要时间等待",
            "你的信念，是最强的力量！",
            "一路前行，终会遇见光！",
            "每一步，都在靠近梦想！",
            "你本身，就是无限可能"
        ];

        // 全局基准日期常量
        const BASE_DATE = new Date(2025, 7, 31); // 月份以0起始

        // 基于日期字符串的哈希函数 - 优化版本
        function hashDate(dateStr) {
            let hash = 0;
            if (dateStr.length === 0) return hash;
            
            // 使用一组质数作为种子，增加随机性
            const primes = [31, 37, 41, 43, 47, 53, 59, 61, 67, 71];
            
            for (let i = 0; i < dateStr.length; i++) {
                const char = dateStr.charCodeAt(i);
                // 混合字符值与位置相关的质数
                const prime = primes[i % primes.length];
                
                // 改进的哈希计算方式，增加更多位操作
                hash = (hash * prime + char) >>> 0; // 无符号右移确保为正数
                hash = ((hash << 10) | (hash >>> 22)) >>> 0; // 循环位移增加混淆
            }
            
            // 额外的混淆步骤
            hash = (hash ^ (hash >>> 16)) >>> 0;
            hash = (hash * 0x85ebca6b) >>> 0;
            hash = (hash ^ (hash >>> 13)) >>> 0;
            hash = (hash * 0xc2b2ae35) >>> 0;
            hash = (hash ^ (hash >>> 16)) >>> 0;
            
            return Math.abs(hash);
        }

        // 从sayings中根据日期随机抽取一句话
        function getDailySaying() {
            const now = new Date();
            const dateStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
            const hash = hashDate(dateStr);
            const index = hash % sayings.length;
            return sayings[index];
        }

        // 获取火花已点燃的天数
        function getSparkDays() {
            // 从本地存储获取火花数据
            const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
            return sparkData.length;
        }

        // 获取连续点燃天数
        function getConsecutiveSparkDays() {
            const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
            if (sparkData.length === 0) return 0;

            // 按日期排序
            sparkData.sort((a, b) => new Date(a.date) - new Date(b.date));

            const now = new Date();
            const todayStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;

            // 计算昨天的日期
            const yesterday = new Date(now);
            yesterday.setDate(now.getDate() - 1);
            const yesterdayStr = `${yesterday.getFullYear()}-${yesterday.getMonth() + 1}-${yesterday.getDate()}`;

            // 检查今天是否点燃
            const hasTodaySpark = sparkData.some(item => item.date === todayStr);
            // 检查昨天是否点燃
            const hasYesterdaySpark = sparkData.some(item => item.date === yesterdayStr);

            // 如果今天没点且昨天也没点，火花已熄灭
            if (!hasTodaySpark && !hasYesterdaySpark) {
                return 0;
            }

            // 查找最后一次点燃的日期
            let lastSparkDate = new Date(sparkData[sparkData.length - 1].date);
            let consecutiveDays = 1;

            // 从最后一次点燃的日期向前检查连续天数
            for (let i = sparkData.length - 2; i >= 0; i--) {
                const prevDate = new Date(sparkData[i].date);
                const diffTime = lastSparkDate - prevDate;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                if (diffDays === 1) {
                    consecutiveDays++;
                    lastSparkDate = prevDate;
                } else {
                    break;
                }
            }

            // 如果今天没点但昨天点了，需要确认最后一次点燃是否是昨天
            if (!hasTodaySpark && hasYesterdaySpark) {
                const lastSpark = sparkData[sparkData.length - 1];
                if (lastSpark.date === yesterdayStr) {
                    return consecutiveDays;
                } else {
                    return 0;
                }
            }

            return consecutiveDays;
        }

        // 检查今天是否已经点燃火花
        function hasSparkedToday() {
            const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
            const now = new Date();
            const todayStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
            return sparkData.some(item => item.date === todayStr);
        }

        // 点燃火花
        async function igniteSpark() {
            try {
                // 调用第三方时间接口获取可信时间
                const response = await fetch('https://cn.apihz.cn/api/time/getapi.php?id=10007502&key=ef8080bb3f865a67dd17203064d70dc0&type=2');
                if (!response.ok) {
                    throw new Error('获取标准北京时间失败，请检查网络连接或刷新重试');
                }
                const timeData = await response.json();
                const serverDate = new Date(timeData.msg);
                const serverDateStr = `${serverDate.getFullYear()}-${serverDate.getMonth() + 1}-${serverDate.getDate()}`;

                // 获取本地时间
                const now = new Date();
                const todayStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;

                // 比较本地日期与服务器日期
                if (todayStr !== serverDateStr) {
                    alert('时间穿越是被禁止的！');
                    return false;
                }

                // 检查是否有未来的火花记录
                const sparkDataFuture = JSON.parse(localStorage.getItem('sparkData')) || [];
                const hasFutureSpark = sparkDataFuture.some(item => {
                    const sparkDate = new Date(item.date);
                    return sparkDate > now;
                });

                if (hasFutureSpark) {
                    alert('时间穿越是被禁止的！');
                    return false;
                }

                // 如果今天已经点燃，直接返回
                if (hasSparkedToday()) {
                    return false;
                }

                // 基于日期哈希选择鼓励消息，确保同一天在不同设备上结果一致
                const dateStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
                const hash = hashDate(dateStr);
                const index = hash % encourageMessages.length;
                const randomEncourage = encourageMessages[index];
                // 使用正则表达式提取第一个emoji
                const emojiMatch = randomEncourage.match(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{1F700}-\u{1F77F}\u{1F780}-\u{1F7FF}\u{1F800}-\u{1F8FF}\u{1F900}-\u{1F9FF}\u{1FA00}-\u{1FA6F}\u{1FA70}-\u{1FAFF}\u{0023}-\u{0026}\u{0030}-\u{0039}\u{2000}-\u{303F}\u{FE00}-\u{FE0F}\u{1F1E6}-\u{1F1FF}]/gu);
                const emoji = emojiMatch ? emojiMatch[0] : '🔥'; // 如果没有找到emoji，使用默认火焰图标

                // 保存到本地存储
                const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
                sparkData.push({
                    date: todayStr,
                    message: randomEncourage,
                    emoji: emoji
                });
                localStorage.setItem('sparkData', JSON.stringify(sparkData));

                return true;
            } catch (error) {
                console.error('点燃火花时出错:', error);
                throw error;
            }
        }

        // 更新火花状态显示
        function updateSparkStatus() {
            const consecutiveDays = getConsecutiveSparkDays();
            const sparkDaysContainer = document.getElementById('spark-days-container');
            const sparkExtinguished = document.getElementById('spark-extinguished');
            const sparkDaysElement = document.getElementById('spark-days');
            
            // 检查今天是否已经点燃火花
            const isTodaySparked = hasSparkedToday();
            
            // 检查昨天是否点燃了火花（判断是否是"今天没点火花，昨天点了火花"的情况）
            const now = new Date();
            const yesterday = new Date(now);
            yesterday.setDate(now.getDate() - 1);
            const yesterdayStr = `${yesterday.getFullYear()}-${yesterday.getMonth() + 1}-${yesterday.getDate()}`;
            const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
            const isYesterdaySparked = sparkData.some(item => item.date === yesterdayStr);
            const isTodayNotSparkedButYesterdaySparked = !isTodaySparked && isYesterdaySparked;

            // 根据连续天数显示不同内容
            if (consecutiveDays === 0) {
                sparkDaysContainer.style.display = 'none';
                sparkExtinguished.style.display = 'block';
            } else {
                sparkDaysContainer.style.display = 'block';
                sparkExtinguished.style.display = 'none';
                sparkDaysElement.textContent = consecutiveDays;
                
                // 当今天没点火花，昨天点了火花时，将数字显示为灰色
                  if (isTodayNotSparkedButYesterdaySparked) {
                      sparkDaysElement.style.color = '#9e9e9e'; // 灰色
                       // 移除已存在的等级图标元素
                      let levelIconsElement = document.getElementById('level-icons');
                      if (levelIconsElement) {
                          sparkDaysContainer.removeChild(levelIconsElement);
                      }
                  } else {
                      sparkDaysElement.style.color = '#ff80ab'; // 原来的粉色
                      
                      // 只有今天点完火花才显示等级图标
                      if (isTodaySparked) {
                          generateLevelIcons(consecutiveDays);
                      } else {
                          // 移除已存在的等级图标元素
                          let levelIconsElement = document.getElementById('level-icons');
                          if (levelIconsElement) {
                              sparkDaysContainer.removeChild(levelIconsElement);
                          }
                      }
                  }
            }

            // 如果今天已经点燃，更新按钮文本
            if (hasSparkedToday()) {
                const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];
                const now = new Date();
                const todayStr = `${now.getFullYear()}-${now.getMonth() + 1}-${now.getDate()}`;
                const todaySpark = sparkData.find(item => item.date === todayStr);
                if (todaySpark) {
                    const sparkButton = document.getElementById('spark-button');
                    sparkButton.textContent = todaySpark.message;
                    sparkButton.classList.add('emoji-font');
                    sparkButton.style.whiteSpace = 'pre-line';
                    sparkButton.style.textAlign = 'center';
                    sparkButton.style.padding = '10px';
                }
            }
        }
        
        // 生成等级图标
        function generateLevelIcons(days) {
            const sparkDaysContainer = document.getElementById('spark-days-container');
            
            // 移除已存在的等级图标元素
            let levelIconsElement = document.getElementById('level-icons');
            if (levelIconsElement) {
                sparkDaysContainer.removeChild(levelIconsElement);
            }

            // 创建新的等级图标元素
            levelIconsElement = document.createElement('div');
            levelIconsElement.id = 'level-icons';
            levelIconsElement.classList.add('emoji-font');
            levelIconsElement.style.marginTop = '0px';
            levelIconsElement.style.fontSize = '14px';
            levelIconsElement.style.textAlign = 'center';

            // 等级图标定义
            const levelIcons = [
                { threshold: 625, icon: '👑' },
                { threshold: 125, icon: '🌞' },
                { threshold: 25, icon: '🌋' },
                { threshold: 5, icon: '💥' },
                { threshold: 1, icon: '🔥' }
            ];

            let remainingDays = days;
            let icons = '';

            // 从大到小分解天数生成图标
            for (const level of levelIcons) {
                if (remainingDays >= level.threshold) {
                    const count = Math.floor(remainingDays / level.threshold);
                    icons += level.icon.repeat(count);
                    remainingDays %= level.threshold;
                }
            }

            levelIconsElement.textContent = icons;
            sparkDaysContainer.appendChild(levelIconsElement);
        }

        // 计算离下次报告的天数（下一个周六）
        function getDaysUntilNextReport() {
            const now = new Date();
            const currentDay = now.getDay(); // 0是周日，6是周六
            let daysUntilSaturday;

            if (currentDay === 6) {
                // 今天是周六
                return 0;
            } else {
                // 计算到下周六的天数
                daysUntilSaturday = 6 - currentDay;
                return daysUntilSaturday;
            }
        }

        // 初始化LearnME板块
        function initLearnME() {
            // 获取第一行：每日名言
            const dailySaying = getDailySaying();
            document.getElementById('encourage-message').textContent = '「 ' + dailySaying + ' 」';

            // 更新火花状态
            updateSparkStatus();

            // 第四行：离下次报告的天数
            const daysUntilReport = getDaysUntilNextReport();
            const reportElement = document.getElementById('next-report');
            if (daysUntilReport === 0) {
                reportElement.innerHTML = '下次报告<span class="highlight">就是今天</span>';
            } else {
                reportElement.innerHTML = `离下次报告还有<span class="highlight">${daysUntilReport}</span>天`;
            }

            // 第五行：坚持的天数
            const persistDays = getDayDifference() + 1;
            document.getElementById('persist-days').textContent = persistDays;

            // 进度条：计算百分比
            const progressPercent = (persistDays / studyPlans.length) * 100;
            const progressBar = document.getElementById('progress-bar');
            const progressFill = progressBar.querySelector('.progress-fill');
            const progressText = document.getElementById('progress-text');

            // 限制在0-100%之间
            const clampedPercent = Math.max(0, Math.min(100, progressPercent));
            progressFill.style.width = `${clampedPercent}%`;
            progressText.textContent = clampedPercent.toFixed(2) + '%';

            // 计算进度文本位置，使其显示在进度条对应位置的下方
            // 获取进度条宽度
            const progressBarWidth = progressBar.offsetWidth;
            // 计算进度在进度条上的位置
            const progressPosition = (clampedPercent / 100) * progressBarWidth;
            // 获取文本宽度
            const textWidth = progressText.offsetWidth;
            // 设置文本位置
            let textPosition;
            const threshold = textWidth / 2; // 阈值，用于判断是否靠近边界

            // 当进度位置小于阈值时，左对齐（与进度条左边界对齐）
            if (progressPosition < threshold) {
                textPosition = 0;
            }
            // 当进度位置大于进度条宽度减去阈值时，右对齐（与进度条右边界对齐）
            else if (progressPosition > progressBarWidth - threshold) {
                textPosition = progressBarWidth - textWidth;
            }
            // 其他情况居中（相对于进度位置）
            else {
                textPosition = progressPosition - textWidth / 2;
            }

            progressText.style.left = `${textPosition}px`;
        }

        // 获取当前日期
        function getCurrentDate() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const date = now.getDate();
            const day = now.getDay();
            const weekdays = ['日', '一', '二', '三', '四', '五', '六'];

            return `${year}年${month}月${date}日 星期${weekdays[day]}`;
        }

        // 计算与基准日期的差值
        function getDayDifference() {
            const baseDate = BASE_DATE; // 使用全局基准日期常量
            const now = new Date();

            // 设置时间为0点，只比较日期
            baseDate.setHours(0, 0, 0, 0);
            now.setHours(0, 0, 0, 0);

            const diffTime = now - baseDate;
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

            return diffDays;
        }

        // 获取今日学习计划
        function getTodayStudyPlan() {
            const dayDiff = getDayDifference();
            const planIndex = dayDiff >= 0 ? dayDiff % studyPlans.length : (studyPlans.length + dayDiff % studyPlans.length) % studyPlans.length;

            return studyPlans[planIndex];
        }

        // 获取本周学习计划
        function getWeekStudyPlans() {
            const now = new Date();
            const currentDay = now.getDay(); // 0是周日，1是周一，以此类推
            const dayDiff = getDayDifference();

            // 计算本周周日的索引
            const sundayIndex = dayDiff - currentDay;

            const weekPlans = [];
            for (let i = 0; i < 7; i++) {
                const planIndex = (sundayIndex + i) % studyPlans.length;
                const adjustedIndex = planIndex >= 0 ? planIndex : (studyPlans.length + planIndex) % studyPlans.length;
                weekPlans.push({
                    day: i,
                    plan: studyPlans[adjustedIndex]
                });
            }

            return weekPlans;
        }

        // 初始化页面
        function initPage() {
            // 设置当前日期
            document.getElementById('current-date').textContent = getCurrentDate();

            // 设置今日学习内容
            const todayPlan = getTodayStudyPlan();
            document.getElementById('study-title').textContent = todayPlan[0];
            document.getElementById('study-time').textContent = todayPlan[1];

            // 设置本周计划
            const weekPlans = getWeekStudyPlans();
            const weekdayNames = ['&nbsp;周日', '&nbsp;周一', '&nbsp;周二', '&nbsp;周三', '&nbsp;周四', '&nbsp;周五', '&nbsp;周六'];

            const weekPlanContent = document.getElementById('week-plan-content');

            weekPlans.forEach((item, index) => {
                const dayItem = document.createElement('div');
                dayItem.className = 'day-item';

                // 为今天添加高亮类
                if (index === new Date().getDay()) {
                    dayItem.className += ' today-highlight';
                }

                // 统一所有日期的HTML结构
                const dayName = index === new Date().getDay() ? '&nbsp;今天' : weekdayNames[index];
                dayItem.innerHTML = `<div class="day-name">${dayName}</div>`;

                dayItem.innerHTML += `
                    <div class="day-content">
                        ${item.plan[0]}
                        <div style="color: #666; font-size: 14px;">${item.plan[1]}</div>
                    </div>
                `;

                weekPlanContent.appendChild(dayItem);
            });

            // 设置全部计划列表
            const allPlansList = document.getElementById('all-plans-list');
            studyPlans.forEach((plan, index) => {
                const planItem = document.createElement('div');
                planItem.className = 'plan-item';

                // 计算日期
                const baseDate = BASE_DATE; // 使用全局基准日期常量
                const planDate = new Date(baseDate);
                planDate.setDate(baseDate.getDate() + index);
                const dateStr = `${planDate.getFullYear()}年${planDate.getMonth() + 1}月${planDate.getDate()}日 (Day ${index + 1})`;

                planItem.innerHTML = `
                    <div class="plan-date">${dateStr}</div>
                    <div class="plan-title">${plan[0]}</div>
                    <div class="plan-time">${plan[1]}</div>
                `;

                allPlansList.appendChild(planItem);
            });

            // 设置鼓励消息
            const randomEncourage = encourageMessages[Math.floor(Math.random() * encourageMessages.length)];
            document.getElementById('encourage-message').textContent = randomEncourage;
        }

        // 初始化单词板块
        function initVocabSection() {
            const dayDiff = getDayDifference();
            const vocabHeader = document.getElementById('vocab-header');
            const vocabTitle = document.getElementById('vocab-title');
            const dateCircles = document.getElementById('date-circles');

            // 设置标题和背景色（使用绝对值确保负数差值也能正确判断奇偶）
            if (Math.abs(dayDiff) % 2 === 1) {
                vocabTitle.textContent = '背单词';
                vocabHeader.style.backgroundColor = 'green';
            } else {
                vocabTitle.textContent = '不背单词';
                vocabHeader.style.backgroundColor = 'gray';
            }

            // 清空日期圆圈容器
            dateCircles.innerHTML = '';

            // 添加7个日期圆圈（今天和前六天）
            const now = new Date();
            for (let i = 6; i >= 0; i--) {
                const currentDate = new Date();
                currentDate.setDate(now.getDate() - i);

                const circle = document.createElement('div');
                circle.className = 'date-circle';

                // 计算该日期与基准日期的差值
                const baseDate = BASE_DATE; // 使用全局基准日期常量
                baseDate.setHours(0, 0, 0, 0);
                currentDate.setHours(0, 0, 0, 0);
                const diffTime = currentDate - baseDate;
                const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                // 设置圆圈颜色（使用绝对值确保负数差值也能正确判断奇偶）
                if (Math.abs(diffDays) % 2 === 1) {
                    circle.classList.add('circle-green');
                } else {
                    circle.classList.add('circle-gray');
                }

                // 设置圆圈内容
                if (i === 0) {
                    circle.textContent = '今';
                } else {
                    circle.textContent = currentDate.getDate();
                }

                dateCircles.appendChild(circle);
            }
        }

        // 实现页面重新初始化功能，删除所有组件并重新加载
        function reinitializePage() {
            try {
                // console.log('重新初始化...');
                // 保存必要的数据（如滚动位置）
                const scrollPosition = window.scrollY;
                
                // 清空原有的页面内容，确保完全重新初始化
                // 1. 清空今日学习板块
                const studyTitle = document.getElementById('study-title');
                const studyTime = document.getElementById('study-time');
                const weekPlanContent = document.getElementById('week-plan-content');
                const allPlansList = document.getElementById('all-plans-list');
                const currentDate = document.getElementById('current-date');
                const togglePreview = document.getElementById('toggle-preview');
                const weekPlan = document.getElementById('week-plan');
                
                if (allPlansList) allPlansList.innerHTML = '';
                if (studyTitle) studyTitle.textContent = '';
                if (studyTime) studyTime.textContent = '';
                if (weekPlanContent) weekPlanContent.innerHTML = '';
                if (currentDate) currentDate.textContent = '';
                if (togglePreview) togglePreview.textContent = '计划预览';
                if (weekPlan) weekPlan.classList.remove('active');
                
                // 2. 清空单词板块
                const vocabTitle = document.getElementById('vocab-title');
                const dateCircles = document.getElementById('date-circles');
                const vocabHeader = document.getElementById('vocab-header');
                
                if (vocabTitle) vocabTitle.textContent = '';
                if (dateCircles) dateCircles.innerHTML = '';
                
                // 3. 清空LearnME板块
                const encourageMessage = document.getElementById('encourage-message');
                const sparkDaysContainer = document.getElementById('spark-days-container');
                const sparkExtinguished = document.getElementById('spark-extinguished');
                const nextReport = document.getElementById('next-report');
                const persistDays = document.getElementById('persist-days');
                const progressFill = document.querySelector('.progress-fill');
                const progressText = document.getElementById('progress-text');
                const sparkDays = document.getElementById('spark-days');
                const sparkStatusContainer = document.getElementById('spark-status-container');
                
                if (encourageMessage) encourageMessage.textContent = '';
                if (sparkDaysContainer) sparkDaysContainer.style.display = 'none';
                if (sparkExtinguished) sparkExtinguished.style.display = 'none';
                if (nextReport) nextReport.innerHTML = '';
                if (persistDays) persistDays.textContent = '';
                if (progressFill) progressFill.style.width = '0%';
                if (progressText) progressText.textContent = '0.00%';
                if (sparkDays) sparkDays.textContent = '0';
                if (sparkDays) sparkDays.style.color = '#ff80ab';
                
                // 4. 清空火花按钮
                const sparkButton = document.getElementById('spark-button');
                if (sparkButton) {
                    sparkButton.textContent = '点燃火花';
                    sparkButton.classList.remove('emoji-font');
                    sparkButton.style.whiteSpace = '';
                    sparkButton.style.textAlign = '';
                    sparkButton.style.padding = '';
                }
                
                // 5. 移除等级图标元素（如果存在）
                const levelIconsElement = document.getElementById('level-icons');
                if (levelIconsElement && sparkDaysContainer) {
                    sparkDaysContainer.removeChild(levelIconsElement);
                }
                
                // 6. 重置弹窗相关元素
                const allPlansModal = document.getElementById('all-plans-modal');
                if (allPlansModal) allPlansModal.style.display = 'none';
                document.body.style.overflow = ''; // 确保背景滚动始终可用

                // 重新初始化所有组件
                initPage();
                initVocabSection();
                initLearnME();
                // 恢复滚动位置
                window.scrollTo(0, scrollPosition);
            } catch (error) {
                console.error('页面重新初始化失败:', error);
            }
        }

        // 监听页面可见性变化
        function setupVisibilityListener() {
            document.addEventListener('visibilitychange', function() {
                if (document.visibilityState === 'visible') {
                    // 直接重新初始化页面
                    reinitializePage();
                }
            });
        }

        // 事件监听
        document.addEventListener('DOMContentLoaded', function () {
            // 设置页面可见性变化监听
            setupVisibilityListener();

            // 初始化页面组件
            initPage();
            initVocabSection();
            initLearnME();
            
            // 计划预览按钮
            document.getElementById('toggle-preview').addEventListener('click', function () {
                const weekPlan = document.getElementById('week-plan');
                weekPlan.classList.toggle('active');
                this.textContent = weekPlan.classList.contains('active') ? '收起预览' : '计划预览';
            });

            // 显示全部计划
            document.getElementById('show-all-plans').addEventListener('click', function () {
                const modal = document.getElementById('all-plans-modal');
                modal.style.display = 'block';

                // 禁止背景页面滚动
                document.body.style.overflow = 'hidden';

                // 高亮并定位到今天的计划
                highlightTodayPlan();
            });

            // 点燃火花按钮点击事件
            document.getElementById('spark-button').addEventListener('click', async function () {
                if (hasSparkedToday()) {
                    // 今天已经点燃，显示火花日历弹窗
                    showSparkCalendar();
                } else {
                    // 点燃火花
                    try {
                        const success = await igniteSpark();
                        if (success) {
                            // 更新火花状态
                            updateSparkStatus();
                            // 显示成功消息
                            alert('火花已点燃！');
                        }
                    } catch (error) {
                        console.error('点燃火花失败:', error);
                        alert('获取标准北京时间失败，请检查网络连接或刷新重试');
                    }
                }
            });

            // 显示火花日历弹窗
            function showSparkCalendar() {
                // 记录当前滚动位置
                const scrollY = window.scrollY;

                // 创建弹窗元素
                const modal = document.createElement('div');
                modal.className = 'calendar-modal';
                modal.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background-color: rgba(0, 0, 0, 0.5);
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        z-index: 1000;
                        overflow-y: auto;
                    `;

                // 禁止背景页面滚动
                document.body.style.overflow = 'hidden';
                document.body.style.position = 'fixed';
                document.body.style.width = '100%';
                document.body.style.top = `-${scrollY}px`;

                // 创建弹窗内容
                const modalContent = document.createElement('div');
                modalContent.className = 'calendar-modal-content';
                modalContent.style.cssText = `
                    background-color: white;
                    padding: 20px;
                    border-radius: 10px;
                    width: 350px;
                    max-width: 90%;
                `;

                // 添加标题
                const title = document.createElement('h3');
                title.textContent = '火花日历';
                title.style.textAlign = 'center';
                modalContent.appendChild(title);

                // 添加月份选择器
                const monthSelector = document.createElement('div');
                monthSelector.style.cssText = 'display: flex; justify-content: space-between; margin: 15px 0;';

                const prevBtn = document.createElement('button');
                prevBtn.innerHTML = '&#9664;'; // 左箭头符号
                prevBtn.className = 'no-highlight calendar-nav-btn';
                prevBtn.style.cssText = `
                    padding: 3px 6px;
                    background-color: #f0f0f0;
                    color: #888;
                    border: none;
                    border-radius: 3px;
                    cursor: pointer;
                    font-size: 10px;
                `;
                prevBtn.onclick = () => renderCalendar(currentMonth - 1);

                const nextBtn = document.createElement('button');
                nextBtn.innerHTML = '&#9654;'; // 右箭头符号
                nextBtn.className = 'no-highlight calendar-nav-btn';
                nextBtn.style.cssText = `
                    padding: 3px 6px;
                    background-color: #f0f0f0;
                    color: #888;
                    border: none;
                    border-radius: 3px;
                    cursor: pointer;
                    font-size: 10px;
                `;
                nextBtn.onclick = () => renderCalendar(currentMonth + 1);

                const monthDisplay = document.createElement('span');
                monthDisplay.id = 'calendar-month';

                monthSelector.appendChild(prevBtn);
                monthSelector.appendChild(monthDisplay);
                monthSelector.appendChild(nextBtn);
                modalContent.appendChild(monthSelector);

                // 创建日历表格
                const calendarTable = document.createElement('table');
                calendarTable.style.width = '100%';
                calendarTable.style.borderCollapse = 'collapse';

                // 创建星期标题行
                const weekHeader = document.createElement('tr');
                const weekdays = ['日', '一', '二', '三', '四', '五', '六'];
                weekdays.forEach(day => {
                    const th = document.createElement('th');
                    th.textContent = day;
                    th.style.border = '1px solid #ddd';
                    th.style.textAlign = 'center';
                    th.style.padding = '5px';
                    weekHeader.appendChild(th);
                });
                calendarTable.appendChild(weekHeader);

                // 创建日期容器
                const dateContainer = document.createElement('tbody');
                dateContainer.id = 'calendar-dates';
                calendarTable.appendChild(dateContainer);
                modalContent.appendChild(calendarTable);

                // 添加按钮容器
                const btnContainer = document.createElement('div');
                btnContainer.style.cssText = `
                    margin-top: 15px;
                    display: flex;
                    justify-content: center;
                    gap: 10px;
                `;
                modalContent.appendChild(btnContainer);

                // 添加加载按钮
                const loadBtn = document.createElement('button');
                loadBtn.textContent = '加载';
                loadBtn.className = 'no-highlight';
                loadBtn.style.cssText = `
                    padding: 8px 15px;
                    background-color: #2196F3;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                `;
                loadBtn.onclick = showLoadOptions;
                btnContainer.appendChild(loadBtn);

                // 添加保存按钮
                const saveBtn = document.createElement('button');
                saveBtn.textContent = '保存';
                saveBtn.className = 'no-highlight';
                saveBtn.style.cssText = `
                    padding: 8px 15px;
                    background-color: #4CAF50;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                `;
                saveBtn.onclick = showSaveOptions;
                btnContainer.appendChild(saveBtn);

                // 添加关闭按钮
                const closeBtn = document.createElement('button');
                closeBtn.textContent = '关闭';
                closeBtn.className = 'no-highlight';
                closeBtn.style.cssText = `
                    padding: 8px 15px;
                    background-color: #f44336;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                `;
                closeBtn.onclick = () => {
                    // 恢复滚动位置
                    const scrollY = parseInt(document.body.style.top || '0');
                    document.body.style.overflow = '';
                    document.body.style.position = '';
                    document.body.style.width = '';
                    document.body.style.top = '';
                    window.scrollTo({ top: -scrollY, behavior: "instant" });

                    // 移除模态框
                    document.body.removeChild(modal);
                };
                btnContainer.appendChild(closeBtn);

                // 显示保存选项菜单
                function showSaveOptions() {
                    // 创建选项菜单
                    const optionsMenu = document.createElement('div');
                    optionsMenu.className = 'save-options-menu';
                    optionsMenu.style.cssText = `
                        position: absolute;
                        background-color: white;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        padding: 10px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                        z-index: 1010;
                    `;

                    // 计算位置（在保存按钮下方）
                    const rect = saveBtn.getBoundingClientRect();
                    const modalRect = modal.getBoundingClientRect();
                    optionsMenu.style.top = (rect.bottom - modalRect.top + 10) + 'px';
                    optionsMenu.style.left = (rect.left - modalRect.left) + 'px';

                    // 添加保存到文件选项
                    const saveToFileBtn = document.createElement('button');
                    saveToFileBtn.textContent = '保存到文件';
                    saveToFileBtn.style.cssText = `
                        display: block;
                        padding: 8px 12px;
                        text-align: left;
                        background-color: #f9f9f9;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        margin-bottom: 5px;
                        cursor: pointer;
                    `;
                    saveToFileBtn.onclick = function () {
                        downloadData();
                        modalContent.removeChild(optionsMenu);
                    };
                    optionsMenu.appendChild(saveToFileBtn);

                    // 添加保存到剪贴板选项
                    const saveToClipboardBtn = document.createElement('button');
                    saveToClipboardBtn.textContent = '复制为文本';
                    saveToClipboardBtn.style.cssText = `
                        display: block;
                        padding: 8px 12px;
                        text-align: left;
                        background-color: #f9f9f9;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        cursor: pointer;
                    `;
                    saveToClipboardBtn.onclick = function () {
                        copyDataToClipboard();
                        modalContent.removeChild(optionsMenu);
                    };
                    optionsMenu.appendChild(saveToClipboardBtn);

                    // 添加到模态框内容
                    modalContent.appendChild(optionsMenu);

                    // 点击其他地方关闭菜单
                    const closeMenu = function (event) {
                        if (!optionsMenu.contains(event.target) && event.target !== saveBtn) {
                            // 检查optionsMenu是否仍然是modalContent的子节点
                            if (optionsMenu.parentNode === modalContent) {
                                modalContent.removeChild(optionsMenu);
                            }
                            document.removeEventListener('click', closeMenu);
                        }
                    };
                    document.addEventListener('click', closeMenu);
                }

                // 显示加载选项菜单
                function showLoadOptions() {
                    // 创建选项菜单
                    const optionsMenu = document.createElement('div');
                    optionsMenu.className = 'load-options-menu';
                    optionsMenu.style.cssText = `
                        position: absolute;
                        background-color: white;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        padding: 10px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                        z-index: 1010;
                        white-space: nowrap;
                    `;

                    // 计算位置（在加载按钮下方）
                    const rect = loadBtn.getBoundingClientRect();
                    const modalRect = modal.getBoundingClientRect();
                    optionsMenu.style.top = (rect.bottom - modalRect.top + 10) + 'px';
                    optionsMenu.style.left = (rect.left - modalRect.left) + 'px';

                    // 添加从文件加载选项
                    const loadFromFileBtn = document.createElement('button');
                    loadFromFileBtn.textContent = '从文件加载';
                    loadFromFileBtn.style.cssText = `
                        display: block;
                        width: 100%;
                        padding: 8px;
                        text-align: left;
                        background-color: #f9f9f9;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        margin-bottom: 5px;
                        cursor: pointer;
                    `;
                    loadFromFileBtn.onclick = function () {
                        loadDataFromFile();
                        modalContent.removeChild(optionsMenu);
                    };
                    optionsMenu.appendChild(loadFromFileBtn);

                    // 添加从文本加载选项
                    const loadFromTextBtn = document.createElement('button');
                    loadFromTextBtn.textContent = '从文本加载';
                    loadFromTextBtn.style.cssText = `
                        display: block;
                        width: 100%;
                        padding: 8px;
                        text-align: left;
                        background-color: #f9f9f9;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        cursor: pointer;
                    `;
                    loadFromTextBtn.onclick = function () {
                        modalContent.removeChild(optionsMenu);
                        showTextInputDialog();
                    };
                    optionsMenu.appendChild(loadFromTextBtn);

                    // 添加到模态框内容
                    modalContent.appendChild(optionsMenu);

                    // 点击其他地方关闭菜单
                    const closeMenu = function (event) {
                        if (!optionsMenu.contains(event.target) && event.target !== loadBtn) {
                            // 检查optionsMenu是否仍然是modalContent的子节点
                            if (optionsMenu.parentNode === modalContent) {
                                modalContent.removeChild(optionsMenu);
                            }
                            document.removeEventListener('click', closeMenu);
                        }
                    };
                    document.addEventListener('click', closeMenu);
                }

                // 从文件加载数据（原loadData函数重命名）
                function loadDataFromFile() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.json';
                    input.onchange = function (e) {
                        const file = e.target.files[0];
                        if (!file) return;

                        const reader = new FileReader();
                        reader.onload = function (event) {
                            try {
                                const content = event.target.result;
                                processImportedData(content);
                            } catch (error) {
                                console.error('数据加载失败:', error);
                                alert('数据加载失败！');
                            }
                        };
                        reader.readAsText(file);
                    };
                    input.click();
                }

                // 显示文本输入对话框
                function showTextInputDialog() {
                    // 创建对话框
                    const textDialog = document.createElement('div');
                    textDialog.className = 'text-input-dialog';
                    textDialog.style.cssText = `
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%);
                        background-color: white;
                        border: 1px solid #ddd;
                        border-radius: 10px;
                        padding: 20px;
                        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                        z-index: 1020;
                        width: 300px;
                    `;

                    // 添加标题
                    const dialogTitle = document.createElement('h4');
                    dialogTitle.textContent = '粘贴数据';
                    dialogTitle.style.marginTop = '0';
                    dialogTitle.style.textAlign = 'center';
                    textDialog.appendChild(dialogTitle);

                    // 添加文本区域
                    const textarea = document.createElement('textarea');
                    textarea.style.cssText = `
                        width: 100%;
                        height: 150px;
                        margin: 10px 0;
                        padding: 10px;
                        box-sizing: border-box;
                        border: 1px solid #ddd;
                        border-radius: 4px;
                        resize: none;
                    `;
                    textarea.placeholder = '请粘贴你从别处保存的数据...';
                    textDialog.appendChild(textarea);

                    // 添加按钮容器
                    const dialogBtnContainer = document.createElement('div');
                    dialogBtnContainer.style.cssText = `
                        display: flex;
                        justify-content: center;
                        gap: 10px;
                    `;
                    textDialog.appendChild(dialogBtnContainer);

                    // 添加确定按钮
                    const confirmBtn = document.createElement('button');
                    confirmBtn.textContent = '确定';
                    confirmBtn.style.cssText = `
                        padding: 8px 15px;
                        background-color: #4CAF50;
                        color: white;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                    `;
                    confirmBtn.onclick = function () {
                        try {
                            const content = textarea.value.trim();
                            if (!content) {
                                throw new Error('请输入数据');
                            }
                            processImportedData(content);
                            modalContent.removeChild(textDialog);
                        } catch (error) {
                            console.error('数据加载失败:', error);
                            alert('数据加载失败！');
                        }
                    };
                    dialogBtnContainer.appendChild(confirmBtn);

                    // 添加取消按钮
                    const cancelBtn = document.createElement('button');
                    cancelBtn.textContent = '取消';
                    cancelBtn.style.cssText = `
                        padding: 8px 15px;
                        background-color: #f44336;
                        color: white;
                        border: none;
                        border-radius: 4px;
                        cursor: pointer;
                    `;
                    cancelBtn.onclick = function () {
                        modalContent.removeChild(textDialog);
                    };
                    dialogBtnContainer.appendChild(cancelBtn);

                    // 添加到模态框内容
                    modalContent.appendChild(textDialog);
                }

                // 处理导入的数据（抽取公共逻辑）
                function processImportedData(content) {
                    const importedData = JSON.parse(content);

                    // 验证格式
                    if (!importedData.sparkData || typeof importedData.hash !== 'string') {
                        throw new Error('数据格式不正确');
                    }

                    // 提取数据并计算哈希
                    const { hash, ...dataWithoutHash } = importedData;
                    const dataStr = JSON.stringify(dataWithoutHash);
                    const computedHash = customHash(dataStr);

                    // 验证哈希
                    if (computedHash !== hash) {
                        alert('校验失败，请检查数据是否更改或损坏');
                        return;
                    }

                    // 获取本地现有数据
                    const localSparkData = JSON.parse(localStorage.getItem('sparkData') || '[]');

                    // 创建一个以日期为键的映射，优先保留本地数据
                    const sparkDataMap = new Map();

                    // 先添加本地数据
                    localSparkData.forEach(item => {
                        sparkDataMap.set(item.date, item);
                    });

                    // 再添加导入数据中本地没有的日期，只保留date和emoji字段
                    importedData.sparkData.forEach(item => {
                        if (!sparkDataMap.has(item.date)) {
                            sparkDataMap.set(item.date, {
                                date: item.date,
                                emoji: item.emoji || '🔥', // 如果没有emoji，使用默认值
                                message: '' // 保留空message字段以避免可能的错误
                            });
                        }
                    });

                    // 转换回数组并保存
                    const mergedSparkData = Array.from(sparkDataMap.values());
                    localStorage.setItem('sparkData', JSON.stringify(mergedSparkData));

                    alert('数据加载成功！');
                    renderCalendar(currentMonth); // 重新渲染日历
                    updateSparkStatus(); // 更新火花状态
                }

                // 实现独特哈希函数
                function customHash(str) {
                    // 高安全性哈希算法，避免前导零
                    // 使用多个素数作为初始值
                    let h1 = 0x67452301;
                    let h2 = 0xEFCDAB89;
                    let h3 = 0x98BADCFE;
                    let h4 = 0x10325476;

                    if (str.length === 0) {
                        // 空字符串返回固定哈希值
                        return '5d24b7a76b4b451f81b869cd733910ab';
                    }

                    // 处理输入字符串
                    for (let i = 0; i < str.length; i++) {
                        const char = str.charCodeAt(i);

                        // 四轮不同的哈希计算
                        h1 = ((h1 << 5) | (h1 >>> 27)) + h2 + char;
                        h2 = ((h2 << 5) | (h2 >>> 27)) + h3 + char * 3;
                        h3 = ((h3 << 5) | (h3 >>> 27)) + h4 + char * 7;
                        h4 = ((h4 << 5) | (h4 >>> 27)) + h1 + char * 13;

                        // 使用大素数进行混合
                        h1 = h1 * 16777619 ^ h2;
                        h2 = h2 * 1099511628211 ^ h3;
                        h3 = h3 * 2684354561 ^ h4;
                        h4 = h4 * 65537 ^ h1;
                    }

                    // 合并四个哈希值
                    let hash = h1 ^ h2 ^ h3 ^ h4;
                    hash = hash & 0xFFFFFFFF; // 确保是32位整数

                    // 转换为十六进制
                    let hashHex = Math.abs(hash).toString(16);

                    // 确保长度为32位
                    if (hashHex.length < 32) {
                        // 使用基于哈希值的确定性填充，而非随机
                        const padding = generateDeterministicPadding(hash, 32 - hashHex.length);
                        hashHex = padding + hashHex;
                    } else if (hashHex.length > 32) {
                        hashHex = hashHex.slice(-32);
                    }

                    return hashHex;
                }

                // 生成确定性填充字符串
                function generateDeterministicPadding(seed, length) {
                    const chars = '123456789abcdef';
                    let padding = '';
                    let state = seed;

                    for (let i = 0; i < length; i++) {
                        // 使用简单的伪随机算法，但基于种子确保确定性
                        state = (state * 1664525 + 1013904223) & 0xFFFFFFFF;
                        const index = Math.abs(state) % chars.length;
                        padding += chars[index];
                    }

                    return padding;
                }


                // 下载数据函数
                function downloadData() {
                    try {
                        // 收集要导出的数据，只保留date和emoji字段
                        const sparkData = JSON.parse(localStorage.getItem('sparkData') || '[]');
                        const filteredSparkData = sparkData.map(item => ({
                            date: item.date,
                            emoji: item.emoji
                        }));
                        const exportData = {
                            sparkData: filteredSparkData,
                            exportDate: new Date().toISOString()
                        };

                        // 计算哈希值
                        const dataStr = JSON.stringify(exportData);
                        const hash = customHash(dataStr);

                        // 添加哈希值到数据
                        const finalData = {
                            ...exportData,
                            hash: hash
                        };

                        // 创建下载链接
                        const blob = new Blob([JSON.stringify(finalData, null, 2)], { type: 'application/json' });
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        a.href = url;
                        a.download = `learnme_spark_data_${new Date().toISOString().slice(0, 10)}.json`;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    } catch (error) {
                        console.error('导出数据失败:', error);
                        alert('导出数据失败！');
                    }
                }

                // 复制数据到剪贴板函数
                function copyDataToClipboard() {
                    try {
                        // 收集要导出的数据，只保留date和emoji字段
                        const sparkData = JSON.parse(localStorage.getItem('sparkData') || '[]');
                        const filteredSparkData = sparkData.map(item => ({
                            date: item.date,
                            emoji: item.emoji
                        }));
                        const exportData = {
                            sparkData: filteredSparkData,
                            exportDate: new Date().toISOString()
                        };

                        // 计算哈希值
                        const dataStr = JSON.stringify(exportData);
                        const hash = customHash(dataStr);

                        // 添加哈希值到数据
                        const finalData = {
                            ...exportData,
                            hash: hash
                        };

                        // 转换为字符串
                        const finalDataStr = JSON.stringify(finalData, null, 2);

                        // 复制到剪贴板
                        if (navigator.clipboard && navigator.clipboard.writeText) {
                            // 现代浏览器
                            navigator.clipboard.writeText(finalDataStr)
                                .then(() => {
                                    alert('数据已复制到剪贴板！请在合适的地方保管你的数据');
                                })
                                .catch(err => {
                                    throw new Error('复制失败: ' + err);
                                });
                        } else if (document.queryCommandSupported && document.queryCommandSupported('copy')) {
                            // 旧版浏览器
                            const textarea = document.createElement('textarea');
                            textarea.textContent = finalDataStr;
                            textarea.style.position = 'fixed';
                            document.body.appendChild(textarea);
                            textarea.select();
                            try {
                                document.execCommand('copy');
                                alert('数据已复制到剪贴板！请在合适的地方保管你的数据');
                            } catch (ex) {
                                throw new Error('复制失败: ' + ex);
                            } finally {
                                document.body.removeChild(textarea);
                            }
                        } else {
                            throw new Error('您的浏览器不支持剪贴板复制功能');
                        }
                    } catch (error) {
                        console.error('复制数据失败:', error);
                        alert('复制数据失败！');
                    }
                }

                // 加载数据函数
                function loadData() {
                    const input = document.createElement('input');
                    input.type = 'file';
                    input.accept = '.json';
                    input.onchange = function (e) {
                        const file = e.target.files[0];
                        if (!file) return;

                        const reader = new FileReader();
                        reader.onload = function (event) {
                            try {
                                const content = event.target.result;
                                const importedData = JSON.parse(content);

                                // 验证格式
                                if (!importedData.sparkData || typeof importedData.hash !== 'string') {
                                    throw new Error('数据格式不正确');
                                }

                                // 提取数据并计算哈希
                                const { hash, ...dataWithoutHash } = importedData;
                                const dataStr = JSON.stringify(dataWithoutHash);
                                const computedHash = customHash(dataStr);

                                // 验证哈希
                                if (computedHash !== hash) {
                                    alert('校验失败，请检查数据是否更改或损坏');
                                    return;
                                }

                                // 获取本地现有数据
                                const localSparkData = JSON.parse(localStorage.getItem('sparkData') || '[]');

                                // 创建一个以日期为键的映射，优先保留本地数据
                                const sparkDataMap = new Map();

                                // 先添加本地数据
                                localSparkData.forEach(item => {
                                    sparkDataMap.set(item.date, item);
                                });

                                // 再添加导入数据中本地没有的日期，只保留date和emoji字段
                                importedData.sparkData.forEach(item => {
                                    if (!sparkDataMap.has(item.date)) {
                                        sparkDataMap.set(item.date, {
                                            date: item.date,
                                            emoji: item.emoji || '🔥', // 如果没有emoji，使用默认值
                                            message: '' // 保留空message字段以避免可能的错误
                                        });
                                    }
                                });

                                // 转换回数组并保存
                                const mergedSparkData = Array.from(sparkDataMap.values());
                                localStorage.setItem('sparkData', JSON.stringify(mergedSparkData));

                                alert('数据加载成功！');
                                renderCalendar(currentMonth); // 重新渲染日历
                                updateSparkStatus(); // 更新火花状态
                            } catch (error) {
                                alert('校验失败，请检查数据是否更改或损坏');
                            }
                        };
                        reader.readAsText(file);
                    };
                    input.click();
                }

                modal.appendChild(modalContent);
                document.body.appendChild(modal);

                // 渲染日历
                let currentMonth = new Date().getMonth();
                let currentYear = new Date().getFullYear();

                function renderCalendar(month) {
                    currentMonth = month;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    } else if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }

                    // 更新月份显示
                    const monthNames = ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'];
                    document.getElementById('calendar-month').textContent = `${currentYear}年 ${monthNames[currentMonth]}`;

                    // 清空日期容器
                    const dateContainer = document.getElementById('calendar-dates');
                    dateContainer.innerHTML = '';

                    // 获取当月第一天是星期几
                    const firstDay = new Date(currentYear, currentMonth, 1).getDay();
                    // 获取当月有多少天
                    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

                    // 获取火花数据
                    const sparkData = JSON.parse(localStorage.getItem('sparkData')) || [];

                    // 创建日期行
                    let date = 1;
                    for (let i = 0; i < 6; i++) {
                        const row = document.createElement('tr');

                        for (let j = 0; j < 7; j++) {
                            if (i === 0 && j < firstDay) {
                                // 空白单元格
                                const cell = document.createElement('td');
                                cell.style.border = '1px solid #ddd';
                                cell.style.height = '40px';
                                row.appendChild(cell);
                            } else if (date > daysInMonth) {
                                // 超出当月天数
                                break;
                            } else {
                                // 日期单元格
                                const cell = document.createElement('td');
                                cell.style.border = '1px solid #ddd';
                                cell.style.height = '40px';
                                cell.style.textAlign = 'center';
                                cell.style.verticalAlign = 'middle';

                                // 检查是否有火花
                                const dateStr = `${currentYear}-${currentMonth + 1}-${date}`;
                                const spark = sparkData.find(item => item.date === dateStr);

                                if (spark) {
                                    // 有火花，显示emoji
                                    cell.textContent = spark.emoji;
                                    cell.style.backgroundColor = '#e8f5e9';
                                    cell.style.fontSize = '20px';
                                    cell.classList.add('emoji-font');
                                } else {
                                    // 没有火花，显示日期
                                    cell.textContent = date;
                                }

                                row.appendChild(cell);
                                date++;
                            }
                        }

                        dateContainer.appendChild(row);

                        if (date > daysInMonth) {
                            break;
                        }
                    }
                }

                // 初始渲染
                renderCalendar(currentMonth);
            }

            // 高亮并定位到今天的计划
            function highlightTodayPlan() {
                const dayDiff = getDayDifference();
                const planItems = document.querySelectorAll('.plan-item');

                // 移除所有计划项的高亮
                planItems.forEach(item => {
                    item.classList.remove('today-plan-highlight');
                });

                // 高亮今天的计划
                if (planItems[dayDiff]) {
                    planItems[dayDiff].classList.add('today-plan-highlight');

                    // 滚动到今天的计划
                    planItems[dayDiff].scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                }
            }


            // 关闭弹窗
            document.getElementById('close-modal').classList.add('no-highlight');
            document.getElementById('close-modal').addEventListener('click', function () {
                const modal = document.getElementById('all-plans-modal');
                modal.style.display = 'none';

                // 恢复背景页面滚动
                document.body.style.overflow = '';
            });

            // 点击弹窗外部关闭
            window.addEventListener('click', function (event) {
                const modal = document.getElementById('all-plans-modal');
                if (event.target === modal) {
                    modal.style.display = 'none';

                    // 恢复背景页面滚动
                    document.body.style.overflow = '';
                }
            });
        });
    </script>
</body>

</html>